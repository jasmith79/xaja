!function(e,t){if("function"==typeof define&&define.amd)define(["exports","js-typed","decorators-js","utils"],t);else if("undefined"!=typeof exports)t(exports,require("js-typed"),require("decorators-js"),require("utils"));else{var r={exports:{}};t(r.exports,e.jsTyped,e.decoratorsJs,e.utils),e.xaja=r.exports}}(this,function(e,t,r,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(e,"__esModule",{value:!0}),e.toURLString=e.getJSON=e.post=e.get=void 0;var u=o(t),i=(o(r),o(n)),s=function(){function e(e,t){var r=[],n=!0,o=!1,u=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(a){o=!0,u=a}finally{try{!n&&s["return"]&&s["return"]()}finally{if(o)throw u}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=new Error("Sorry but we could not reach the server."),c=u.guard("string",function(e){var t=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)});return btoa(t)}),f=u.Dispatcher([[["string"],function(e){return encodeURIComponent(e)}],[["nil"],function(){return""}],[["object"],function(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}]]),l=u.Dispatcher([[["nil"],function(){return[]}],[["object"],function(e){var t=Object.keys(e),r={},n="",o="",u="";return t.forEach(function(t){var u=e[t];t.match(/user/i)?n=u:t.match(/pass/i)?o=u:r[t]=u}),n&&(u="Basic "+c(n+":"+o)),[f(r),u]}]]);u.defType("__string+",function(e){return e&&u.isType("string",e)}),u.sumType("__string|object","string","object");var d=u.guard(1,["__string+","__string|object"],function(e,t){var r=t?l(t):[null,null],n=s(r,2),o=n[0],u=n[1];return new Promise(function(t,r){var n=e+(o?"?"+o:""),i=new XMLHttpRequest;return i.open("GET",n),u&&i.setRequestHeader("Authorization",u),i.onload=function(){return i.status<400&&i.status>=200?(t(i.responseText),null):(r(new Error("Server responded with a status of "+i.status)),null)},i.onerror=function(){return r(a),null},i.send(),null})}),p=u.guard(["__string+","object"],function(e,t){var r=l(t),n=s(r,2),o=(n[0],n[1]);return new Promise(function(r,n){var u=f(t),i=new XMLHttpRequest;return i.open("POST",e),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),o&&i.setRequestHeader("Authorization",o),i.onload=function(){return i.status<400&&i.status>=200?(r(i.responseText),null):(n(new Error("Server responded with a status of "+i.status)),null)},i.onerror=function(){return n(a),null},i.send(u),null})}),y=function(e,t){return i.unpackJSON(t?d(e,t):d(e))};e.get=d,e.post=p,e.getJSON=y,e.toURLString=f});