(function(a,b){if('function'==typeof define&&define.amd)define(['exports','../node_modules/extracttype/extracttype.js'],b);else if('undefined'!=typeof exports)b(exports,require('../node_modules/extracttype/extracttype.js'));else{var c={exports:{}};b(c.exports,a.extracttype),a.xaja=c.exports}})(this,function(a,b){'use strict';l.defineProperty(a,'__esModule',{value:!0}),a.post=a.getJSON=a.get=a.request=a.fetchLoaded=a.toURLString=void 0;var c=function(a){return a&&a.__esModule?a:{default:a}}(b),d=function(){function a(a,b){var c,d=[],e=!0,f=!1;try{for(var g,h=a[Symbol.iterator]();!(e=(g=h.next()).done)&&(d.push(g.value),!(b&&d.length===b));e=!0);}catch(a){f=!0,c=a}finally{try{!e&&h['return']&&h['return']()}finally{if(f)throw c}}return d}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in l(b))return a(b,c);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),e=new Function('return this;')(),f=e.Promise,g=e.encodeURIComponent,h=e.btoa,i=e.fetch,j=e.localStorage,k=e.Error,l=e.Object,m=e.Request,n=function(a){var b=g(a).replace(/%([0-9A-F]{2})/g,function(a,b){return String.fromCharCode('0x'+b)});return h(b)},o=function(a){if(a){var b=l.entries(a).reduce(function(a,b){var c=d(a,2),e=c[0],f=c[1],g=d(b,2),h=g[0],i=g[1];return h.match(/user/i)?e.user=i:h.match(/pass/i)?e.pass=i:f[h]=i,[e,f]},[{},{}]),c=d(b,2),e=c[0],f=e.user,g=e.pass,h=c[1];return f&&g?['Basic '+n(f+':'+g),h]:[{},h]}return null},p=a.toURLString=function(a){switch((0,c.default)(a)){case'Null':case'Undefined':return'';case'String':return g(a);default:return l.entries(a).map(function(a){var b=d(a,2),c=b[0],e=b[1];return g(c)+'='+g(e)}).join('&');}},q=a.fetchLoaded=new f(function(a,b){if(!i){var c=document.createElement('script');c.src='./node_modules/whatwg-fetch/fetch.js',c.onload=function(){a([e.fetch,e.Request])},c.onerror=function(a){b(a)},e.document.head.appendChild(c)}else a([e.fetch,e.Request])}),r=a.request=function(g){var h=g.url,i=g.data,n=g.method,r=n===void 0?'GET':n,s=g.responseType,t=g.contentType,u=g.timeout,v=u===void 0?0:u,w=g.cache,x=g.headers,y=g.credentials,z=y===void 0?'same-origin':y;if(!h)if('String'===(0,c.default)(g))h=g;else return f.reject(new TypeError('HTTP request must include a url.'));if(!s){var A=h.match(/\.(html|json|text|txt)$/);s=A?'txt'===A[1]?'text':A[1]:'text'}var B,C;if(i)switch((0,c.default)(i)){case'String':t=t||'text/plain;charset=UTF-8',C=i;break;case'FormData':C=i;break;case'Object':var D=o(i),E=d(D,2),F=E[0],a=E[1];B=F,'GET'===r.toUpperCase()?(h=h+'?'+p(a),t=t||'application/x-www-form-urlencoded;charset=UTF-8'):(C=new FormData,l.entries(a).forEach(function(a){var b=d(a,2),c=b[0],e=b[1];C.append(c,e)}));break;default:C=i;}var b=x||new Headers;B&&!b.get('Authorization')&&b.set('Authorization',B),t&&!b.get('Content-Type')&&b.set('Content-Type',t);var G={method:r,headers:b,credentials:z};'GET'!==r.toUpperCase()&&(G.body=C),'POST'!==r.toUpperCase()||G.body||(G.body={});var H=new m(h,G),I=q.then(function(a){var b=d(a,2),c=b[0],g=b[1];return new f(function(a,b){var d=c(H).then(function(a){if(200<=a.status&&300>a.status)return a;var b=new k(a.statusText);b.response=a;var c=j.getItem(h);if(c){console.warn(b.message+' resolving with cached data...');var d=function(){return f.resolve(c)};return{json:d,text:d,blob:d,arrayBuffer:d}}throw b});if(v){var g=setTimeout(function(){var c='Request for '+h+' reached timeout of '+v+'ms.',d=j.getItem(h);if(d){console.warn(c+' resolving with cached data...');var e=function(){return f.resolve(d)};a({json:e,text:e,blob:e,arrayBuffer:e})}else b(new k(c))},v);d.then(function(b){e.clearTimeout(g),a(b)})}else a(d)})});I.request=H;var J,K=s.toLowerCase();switch(K){case'text':case'html':return J=I.then(function(a){return a.text()}).then(function(a){return w&&'GET'===r.toUpperCase()&&j.setItem(h,a),a}),l.defineProperty(J,'request',{get:function(){return I.request}}),J;case'json':return J=I.then(function(a){return a.json()}).then(function(a){return w&&'GET'===r.toUpperCase()&&j.setItem(h,a),a}),l.defineProperty(J,'request',{get:function(){return I.request}}),J;case'blob':case'arrayBuffer':return l.defineProperty(J,'request',{get:function(){return I.request}}),I.then(function(a){return a[K]()});case'stream':default:return I;}},s=a.get=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=l.entries(c).reduce(function(a,b){var c=d(b,2),e=c[0],f=c[1];return a[e]=f,a},{});return e.method='GET',e.url=a,b&&(e.data=b),r(e)},t=a.getJSON=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=l.entries(c).reduce(function(a,b){var c=d(b,2),e=c[0],f=c[1];return a[e]=f,a},{});return e.method='GET',e.url=a,e.responseType='json',b&&(e.data=b),r(e)},u=a.post=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=l.entries(c).reduce(function(a,b){var c=d(b,2),e=c[0],f=c[1];return a[e]=f,a},{});return e.method='POST',e.url=a,b&&(e.data=b),r(e)};a.default=r});