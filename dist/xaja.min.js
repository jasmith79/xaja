!function(e,r){if("function"==typeof define&&define.amd)define(["exports","js-typed","decorators-js","utils"],r);else if("undefined"!=typeof exports)r(exports,require("js-typed"),require("decorators-js"),require("utils"));else{var t={exports:{}};r(t.exports,e.jsTyped,e.decoratorsJs,e.utils),e.xaja=t.exports}}(this,function(e,r,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r["default"]=e,r}Object.defineProperty(e,"__esModule",{value:!0}),e.getJSON=e.post=e.get=void 0;var u=o(r),s=(o(t),o(n)),i=function(){function e(e,r){var t=[],n=!0,o=!1,u=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(t.push(s.value),!r||t.length!==r);n=!0);}catch(a){o=!0,u=a}finally{try{!n&&i["return"]&&i["return"]()}finally{if(o)throw u}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=u.guard("string",function(e){var r=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,r){return String.fromCharCode("0x"+r)});return btoa(r)}),c=u.Dispatcher([[["string"],function(e){return e}],[["nil"],function(){return""}],[["object"],function(e){return Object.keys(e).map(function(r){return encodeURIComponent(r)+"="+encodeURIComponent(e[r])}).join("&")}]]),f=u.Dispatcher([[["nil"],function(){return[]}],[["object"],function(e){var r=Object.keys(e),t={},n="",o="",u="";return r.forEach(function(r){var u=e[r];r.match(/user/i)?n=u:r.match(/pass/i)?o=u:t[r]=u}),n&&(u="Basic "+a(n+":"+o)),[c(t),u]}]]);u.defType("__string+",function(e){return e&&u.isType("string",e)}),u.sumType("__string|object","string","object");var l=u.guard(1,["__string+","__string|object","string"],function(e,r,t){var n=f(r),o=i(n,2),u=o[0],s=o[1];return new Promise(function(r,n){var o=e+"?"+u,i=new XMLHttpRequest;return i.open("GET",o),s&&i.setRequestHeader("Authorization",s),i.onload=function(){if(i.status<400&&i.status>=200){if(t&&"json"===t.toLowerCase()){var e=checkJSON(i.responseText);return e instanceof Error?n(e):r(e),null}return r(i.responseText),null}return n(new Error("Server responded with a status of "+i.status)),null},i.onerror=function(){return n(networkError),null},i.send(),null})}),p=u.guard(2,["__string+","__string|object","string"],function(e,r,t){var n=f(r),o=i(n,2),u=(o[0],o[1]);return new Promise(function(n,o){var s=null==r?"":c(r),i=new XMLHttpRequest;return i.open("POST",e),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),u&&i.setRequestHeader("Authorization",u),i.onload=function(){if(i.status<400&&i.status>=200){if(t&&"json"===t.toLowerCase()){var e=checkJSON(i.responseText);return e instanceof Error?o(e):n(e),null}return n(i.responseText),null}return o(new Error("Server responded with a status of "+i.status)),null},i.onerror=function(){return o(networkError),null},i.send(s),null})}),d=function(e,r){return s.unpackJSON(l(e,r,"json"))};e.get=l,e.post=p,e.getJSON=d});